{% include "./pebbles/lightbox.confirm.html" %}
<script src="{{ assetsUrl }}/js/domready-v2.js"></script>
<script type="text/javascript">
    (function() {
        var lightboxInit = function () {
            if('undefined' === typeof DomReady) {
                setTimeout(lightboxInit, 60);
                return;
            }

            DomReady.ready(function () {
                var content = document.getElementById("xly");
                if (content && content !== document.body.firstChild) {
                    document.body.insertBefore(content, document.body.firstChild);
                }

                var link = document.getElementById("xly-accept-link");
                if (link) {
                    link.addEventListener('click', function (event) {
                        content.classList.add('xly-busy');
                        var url = "{{ migrationInitiateUrl }}";
                        var optout = document.getElementById("xly-subscribe-input");
                        if (optout && optout.checked) {
                            url += '?optout=true';
                        }
                        window.location.replace(url);
                    });
                }
            });
        };

        lightboxInit();
    })();
</script>